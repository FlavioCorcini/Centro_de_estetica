<div class="main-container">

  <div class="stepper">
    <div class="step">
      <div class="circle" [class.active]="passoAtual >= 1">1</div>
      <span>Categoria</span>
    </div>
    <div class="line"></div>
    <div class="step">
      <div class="circle" [class.active]="passoAtual >= 2">2</div>
      <span>Servi√ßo</span>
    </div>
    <div class="line"></div>
    <div class="step">
      <div class="circle" [class.active]="passoAtual >= 3">3</div>
      <span>Profissional</span>
    </div>
    <div class="line"></div>
    <div class="step">
      <div class="circle" [class.active]="passoAtual >= 4">4</div>
      <span>Data/Hora</span>
    </div>
  </div>

  <div class="content-card">

    <div *ngIf="passoAtual === 1" class="fade-in">
      <div class="header-section">
        <h2>Escolha a Categoria</h2>
        <p>Selecione o tipo de servi√ßo desejado</p>
      </div>
      <div class="grid-areas">
        <div *ngFor="let area of areas" class="card-option" 
             [class.selected]="areaSelecionada?.id === area.id"
             (click)="selecionarArea(area)">
          <div class="card-text">
            <h3>{{ area.nome }}</h3>
            <p>{{ area.descricao }}</p>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="passoAtual === 2" class="fade-in">
      <div class="header-section">
        <button class="btn-voltar-link" (click)="voltar()">‚Üê Voltar</button>
        <h2>Escolha o Servi√ßo</h2>
        <p>Categoria: <strong>{{ areaSelecionada?.nome }}</strong></p>
      </div>
      <div class="grid-servicos">
        <div *ngFor="let servico of servicos" class="card-servico" (click)="selecionarServico(servico)">
          <div class="servico-info">
            <h3>{{ servico.nome }}</h3>
            <p>{{ servico.descricao }}</p>
            <small>‚è± {{ servico.tempoAtendimento }} min</small>
          </div>
          <div class="servico-preco">{{ servico.valor | currency:'BRL' }}</div>
        </div>
      </div>
    </div>

    <div *ngIf="passoAtual === 3" class="fade-in">
      <div class="header-section">
        <button class="btn-voltar-link" (click)="voltar()">‚Üê Voltar</button>
        <h2>Escolha o Profissional</h2>
        <p>Servi√ßo: <strong>{{ servicoSelecionado?.nome }}</strong></p>
      </div>
      <div class="grid-profissionais">
        <div *ngFor="let prof of profissionais" class="card-profissional" (click)="selecionarProfissional(prof)">
          <div class="avatar">üë§</div>
          <div class="info">
            <h3>{{ prof.nome }}</h3>
            <p>Especialista dispon√≠vel</p>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="passoAtual === 4" class="fade-in split-layout">
      <div class="date-selection">
        <div class="header-section">
          <button class="btn-voltar-link" (click)="voltar()">‚Üê Voltar</button>
          <h2>Selecione a Data e Hor√°rio</h2>
          <p>Profissional: <strong>{{ profissionalSelecionado?.nome }}</strong></p>
        </div>

        <div class="input-group">
          <label>Data:</label>
          <input type="date" name="data" [(ngModel)]="dataSelecionada" 
                 [min]="dataMinima"
                 (change)="atualizarDisponibilidade()" class="custom-input">
        </div>

        <div class="input-group">
          <label>Hor√°rios Dispon√≠veis:</label>
          <div class="grid-horarios">
            <button *ngFor="let h of horariosDisponiveis" 
                    type="button"
                    class="btn-hora"
                    [class.selecionado]="horaSelecionada === h"
                    [class.ocupado]="estaOcupado(h)"
                    [disabled]="estaOcupado(h)"
                    (click)="selecionarHora(h)">
              {{ h }}
            </button>
          </div>
          <small class="info-legenda" *ngIf="dataSelecionada">
            <span class="cor-ocupado"></span> Hor√°rio Indispon√≠vel
          </small>
        </div>

        <div class="input-group" style="margin-top: 20px;">
          <label>Observa√ß√µes para o profissional:</label>
          <textarea 
            [(ngModel)]="observacoesCliente" 
            name="observacoes" 
            class="custom-input" 
            style="resize: none;"
            placeholder="Ex: Tenho prefer√™ncia por tal produto ou restri√ß√£o a..."
            rows="3">
          </textarea>
        </div>
      </div>

      <div class="resumo-card">
        <h3>Resumo do Agendamento</h3>
        <div class="resumo-item">
          <span>Servi√ßo:</span> 
          <strong>{{ servicoSelecionado?.nome }}</strong>
        </div>
        <div class="resumo-item">
          <span>Profissional:</span> 
          <strong>{{ profissionalSelecionado?.nome }}</strong>
        </div>
        <div class="resumo-item">
          <span>Data:</span> 
          <strong>{{ dataSelecionada ? (dataSelecionada | date:'dd/MM/yyyy') : '--' }}</strong>
        </div>
        <div class="resumo-item">
          <span>Hor√°rio:</span> 
          <strong>{{ horaSelecionada || '--' }}</strong>
        </div>
        <div class="resumo-item">
          <span>Valor Total:</span> 
          <strong class="valor">{{ servicoSelecionado?.valor | currency:'BRL' }}</strong>
        </div>

        <button class="btn-confirmar" 
                [disabled]="!dataSelecionada || !horaSelecionada"
                (click)="finalizarAgendamento()">
            Confirmar Agendamento
        </button>
      </div>
    </div>

    <div *ngIf="passoAtual === 5" class="fade-in success-container">
      <div class="success-icon">‚úîÔ∏è</div>
      <h2>Agendamento Confirmado!</h2>
      <p>Tudo pronto! <strong>{{ profissionalSelecionado?.nome }}</strong> estar√° te esperando.</p>
      
      <div class="comprovante-box">
        <h3>Detalhes da Reserva</h3>
        <div class="resumo-item">
          <span>‚úÇÔ∏è Servi√ßo:</span> 
          <strong>{{ servicoSelecionado?.nome }}</strong>
        </div>
        <div class="resumo-item">
          <span>üìÖ Data:</span> 
          <strong>{{ dataSelecionada | date:'dd/MM/yyyy' }}</strong>
        </div>
        <div class="resumo-item">
          <span>‚è∞ Hor√°rio:</span> 
          <strong>{{ horaSelecionada }}</strong>
        </div>
        <div class="resumo-item">
          <span>üí∞ Valor Total:</span> 
          <strong class="valor">{{ servicoSelecionado?.valor | currency:'BRL' }}</strong>
        </div>
      </div>

      <button class="btn-proximo" (click)="resetarFluxo()">
        Fazer Novo Agendamento
      </button>
    </div>

  </div>
</div>